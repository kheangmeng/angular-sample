import{a as ie}from"./chunk-2OQSGMYH.js";import{a as re}from"./chunk-EEFS7JYH.js";import{a as ne}from"./chunk-EWLH7HIC.js";import{c as O}from"./chunk-TZDOR4PY.js";import{b as Z,c as ee}from"./chunk-C7BXDP6U.js";import{b as te,c as oe}from"./chunk-MPWMWIA5.js";import{b as K,c as Q,i as X,j as Y}from"./chunk-KTXETM5X.js";import"./chunk-D3K4DV37.js";import{b as D,c as j,g as q,h as B,j as U,l as W,m as G,s as H,t as $,u as z,w as J}from"./chunk-UAC25CCP.js";import"./chunk-MYBYNWC4.js";import"./chunk-3HX4ON6O.js";import{k as I}from"./chunk-KGMFYYNB.js";import{$a as a,Bc as A,Jb as l,Lb as m,Pc as P,Qb as k,Rb as n,Sb as o,_b as F,aa as S,ba as L,dc as V,fa as R,fc as w,ga as E,ib as C,la as f,ma as h,pb as T,pc as c,rb as N,t as g,tc as s,xc as y,yc as x,zc as M}from"./chunk-P7EQBKWJ.js";var _=class{constructor(i,t){this.email=i;this.password=t}};var b=class e{forbiddenName=P("",{alias:"appForbiddenName"});validate(i){return this.forbiddenName?re(new RegExp(this.forbiddenName(),"i"))(i):null}static \u0275fac=function(t){return new(t||e)};static \u0275dir=N({type:e,selectors:[["","appForbiddenName",""]],inputs:{forbiddenName:[1,"appForbiddenName","forbiddenName"]},features:[A([{provide:j,useExisting:S(()=>e),multi:!0}])]})};var se=e=>({token:e.data?.token,refreshToken:e.data?.refreshToken}),le=e=>e.data.message,me=e=>({token:e.data?.token});var v=class e{constructor(i){this.http=i}apiUrl=ne.apiUrl;login(i){return this.http.post(`${this.apiUrl}/api/auth/login`,i).pipe(g(se))}signup(i){return this.http.post(`${this.apiUrl}/api/auth/signup`,i).pipe(g(le))}logout(){return this.http.post(`${this.apiUrl}/api/auth/logout`,{})}refreshToken(){return this.http.get(`${this.apiUrl}/api/auth/refresh-token`,{headers:{"Content-Type":"application/json","x-refresh-token":`Bearer ${localStorage.getItem("refreshToken")}`}}).pipe(g(me))}static \u0275fac=function(t){return new(t||e)(R(I))};static \u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"})};function ce(e,i){e&1&&(n(0,"mat-error"),s(1," Email is required. "),o())}function ue(e,i){e&1&&(n(0,"mat-error"),s(1," Email is invalid. "),o())}function ge(e,i){e&1&&(n(0,"mat-error"),s(1," Do not include 'test' in email. "),o())}function fe(e,i){if(e&1&&(l(0,ce,2,0,"mat-error"),l(1,ue,2,0,"mat-error"),l(2,ge,2,0,"mat-error")),e&2){w();let t=c(7);m(t.hasError("required")?0:-1),a(),m(t.hasError("email")?1:-1),a(),m(t.hasError("forbiddenName")?2:-1)}}function he(e,i){e&1&&(n(0,"mat-error"),s(1," Password is required. "),o())}function _e(e,i){e&1&&(n(0,"mat-error"),s(1," Password must be at least 8 characters long. "),o())}function be(e,i){if(e&1&&(l(0,he,2,0,"mat-error"),l(1,_e,2,0,"mat-error")),e&2){w();let t=c(13);m(t.hasError("required")?0:-1),a(),m(t.hasError("minlength")?1:-1)}}var pe=class e{constructor(i,t){this.auth=i;this.authApiService=t}router=E(O);login=new _("jonnhdoe@gmail.com","123456789");handleSubmit(){this.authApiService.login(this.login).subscribe({next:i=>{this.auth.setToken(i),this.auth.setRefreshToken(i),this.router.navigate(["profile"],{queryParams:{"first-login":!0,username:"hello"}})},error:i=>{console.log(i)}})}static \u0275fac=function(t){return new(t||e)(C(ie),C(v))};static \u0275cmp=T({type:e,selectors:[["app-login"]],decls:17,vars:5,consts:[["loginForm","ngForm"],["email","ngModel"],["password","ngModel"],[1,"login-wrapper"],[1,"login-form",3,"ngSubmit"],["appearance","outline"],["matInput","","name","email","type","email","placeholder","Email","required","","email","","appForbiddenName","test",3,"ngModelChange","ngModel"],["matInput","","name","password","type","password","placeholder","Password","required","","minlength","8",3,"ngModelChange","ngModel"],["matButton","outlined","type","submit",3,"disabled"]],template:function(t,p){if(t&1){let u=F();n(0,"div",3)(1,"form",4,0),V("ngSubmit",function(){return f(u),h(p.handleSubmit())}),n(3,"mat-form-field",5)(4,"mat-label"),s(5,"Email"),o(),n(6,"input",6,1),M("ngModelChange",function(r){return f(u),x(p.login.email,r)||(p.login.email=r),h(r)}),o(),l(8,fe,3,3),o(),n(9,"mat-form-field",5)(10,"mat-label"),s(11,"Password"),o(),n(12,"input",7,2),M("ngModelChange",function(r){return f(u),x(p.login.password,r)||(p.login.password=r),h(r)}),o(),l(14,be,2,2),o(),n(15,"button",8),s(16," LOGIN "),o()()()}if(t&2){let u=c(2),d=c(7),r=c(13);a(6),y("ngModel",p.login.email),a(2),m(d.invalid&&(d.dirty||d.touched)?8:-1),a(4),y("ngModel",p.login.password),a(2),m(r.invalid&&(r.dirty||r.touched)?14:-1),a(),k("disabled",!u.form.valid)}},dependencies:[J,G,D,q,B,H,z,$,W,U,b,ee,Z,X,K,Q,Y,oe,te],styles:[".login-wrapper[_ngcontent-%COMP%]{margin:100px;display:flex;justify-content:center;align-items:center}.login-form[_ngcontent-%COMP%]{min-width:500px;display:flex;flex-direction:column;gap:6px}.example-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%] + mat-form-field[_ngcontent-%COMP%]{margin-left:8px}"]})};export{pe as Login};
