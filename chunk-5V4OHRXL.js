import{a as K}from"./chunk-KTKLSVXE.js";import{a as re}from"./chunk-EEFS7JYH.js";import{a as te}from"./chunk-EWLH7HIC.js";import{c as O}from"./chunk-D2S57RSW.js";import{b as oe,c as ne}from"./chunk-JWR6QFAV.js";import{b as Q,c as X,h as Y,k as Z}from"./chunk-4B4GDQRK.js";import{b as D,c as j,g as q,h as B,j as U,k as W,l as G,r as H,s as $,t as z,v as J}from"./chunk-67COSBOJ.js";import{b as ee,c as ie}from"./chunk-MMULWHB5.js";import"./chunk-TS4P3KYR.js";import"./chunk-DAQYXWGM.js";import"./chunk-3M4T7ZU7.js";import{k as I}from"./chunk-PBQ54P7Q.js";import{Ib as l,Jb as m,Nc as P,Ob as k,Pb as n,Qb as o,Yb as F,_a as a,aa as S,ba as L,bc as V,dc as w,fa as R,ga as E,hb as C,la as f,ma as h,nc as c,ob as T,qb as N,rc as s,t as g,vc as y,wc as x,xc as M,zc as A}from"./chunk-BNB2VTH5.js";var _=class{constructor(i,t){this.email=i;this.password=t}};var b=class e{forbiddenName=P("",{alias:"appForbiddenName"});validate(i){return this.forbiddenName?re(new RegExp(this.forbiddenName(),"i"))(i):null}static \u0275fac=function(t){return new(t||e)};static \u0275dir=N({type:e,selectors:[["","appForbiddenName",""]],inputs:{forbiddenName:[1,"appForbiddenName","forbiddenName"]},features:[A([{provide:j,useExisting:S(()=>e),multi:!0}])]})};var se=e=>({token:e.data?.token,refreshToken:e.data?.refreshToken}),le=e=>e.data.message,me=e=>({token:e.data?.token});var v=class e{constructor(i){this.http=i}apiUrl=te.apiUrl;login(i){return this.http.post(`${this.apiUrl}/api/auth/login`,i).pipe(g(se))}signup(i){return this.http.post(`${this.apiUrl}/api/auth/signup`,i).pipe(g(le))}logout(){return this.http.post(`${this.apiUrl}/api/auth/logout`,{})}refreshToken(){return this.http.get(`${this.apiUrl}/api/auth/refresh-token`,{headers:{"Content-Type":"application/json","x-refresh-token":`Bearer ${localStorage.getItem("refreshToken")}`}}).pipe(g(me))}static \u0275fac=function(t){return new(t||e)(R(I))};static \u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"})};function ce(e,i){e&1&&(n(0,"mat-error"),s(1," Email is required. "),o())}function ue(e,i){e&1&&(n(0,"mat-error"),s(1," Email is invalid. "),o())}function ge(e,i){e&1&&(n(0,"mat-error"),s(1," Do not include 'test' in email. "),o())}function fe(e,i){if(e&1&&(l(0,ce,2,0,"mat-error"),l(1,ue,2,0,"mat-error"),l(2,ge,2,0,"mat-error")),e&2){w();let t=c(7);m(t.hasError("required")?0:-1),a(),m(t.hasError("email")?1:-1),a(),m(t.hasError("forbiddenName")?2:-1)}}function he(e,i){e&1&&(n(0,"mat-error"),s(1," Password is required. "),o())}function _e(e,i){e&1&&(n(0,"mat-error"),s(1," Password must be at least 8 characters long. "),o())}function be(e,i){if(e&1&&(l(0,he,2,0,"mat-error"),l(1,_e,2,0,"mat-error")),e&2){w();let t=c(13);m(t.hasError("required")?0:-1),a(),m(t.hasError("minlength")?1:-1)}}var pe=class e{constructor(i,t){this.auth=i;this.authApiService=t}router=E(O);login=new _("jonnhdoe@gmail.com","123456789");handleSubmit(){this.authApiService.login(this.login).subscribe({next:i=>{this.auth.setToken(i),this.auth.setRefreshToken(i),this.router.navigate(["profile"],{queryParams:{"first-login":!0,username:"hello"}})},error:i=>{console.log(i)}})}static \u0275fac=function(t){return new(t||e)(C(K),C(v))};static \u0275cmp=T({type:e,selectors:[["app-login"]],decls:17,vars:5,consts:[["loginForm","ngForm"],["email","ngModel"],["password","ngModel"],[1,"login-wrapper"],[1,"login-form",3,"ngSubmit"],["appearance","outline"],["matInput","","name","email","type","email","placeholder","Email","required","","email","","appForbiddenName","test",3,"ngModelChange","ngModel"],["matInput","","name","password","type","password","placeholder","Password","required","","minlength","8",3,"ngModelChange","ngModel"],["matButton","outlined","type","submit",3,"disabled"]],template:function(t,p){if(t&1){let u=F();n(0,"div",3)(1,"form",4,0),V("ngSubmit",function(){return f(u),h(p.handleSubmit())}),n(3,"mat-form-field",5)(4,"mat-label"),s(5,"Email"),o(),n(6,"input",6,1),M("ngModelChange",function(r){return f(u),x(p.login.email,r)||(p.login.email=r),h(r)}),o(),l(8,fe,3,3),o(),n(9,"mat-form-field",5)(10,"mat-label"),s(11,"Password"),o(),n(12,"input",7,2),M("ngModelChange",function(r){return f(u),x(p.login.password,r)||(p.login.password=r),h(r)}),o(),l(14,be,2,2),o(),n(15,"button",8),s(16," LOGIN "),o()()()}if(t&2){let u=c(2),d=c(7),r=c(13);a(6),y("ngModel",p.login.email),a(2),m(d.invalid&&(d.dirty||d.touched)?8:-1),a(4),y("ngModel",p.login.password),a(2),m(r.invalid&&(r.dirty||r.touched)?14:-1),a(),k("disabled",!u.form.valid)}},dependencies:[J,G,D,q,B,H,z,$,W,U,b,ne,oe,Y,Q,X,Z,ie,ee],styles:[".login-wrapper[_ngcontent-%COMP%]{margin:100px;display:flex;justify-content:center;align-items:center}.login-form[_ngcontent-%COMP%]{min-width:500px;display:flex;flex-direction:column;gap:6px}.example-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%] + mat-form-field[_ngcontent-%COMP%]{margin-left:8px}"]})};export{pe as Login};
